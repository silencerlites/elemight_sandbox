[gd_scene load_steps=13 format=3 uid="uid://d4fkjybs8gg1y"]

[ext_resource type="Script" path="res://components/player_control.gd" id="1_gg6jg"]
[ext_resource type="Script" path="res://components/weapon_control.gd" id="2_d5ebt"]
[ext_resource type="PackedScene" uid="uid://d2scn7vq3rybx" path="res://assets/test_object/test_gun.tscn" id="3_vf412"]
[ext_resource type="PackedScene" uid="uid://beae7hyn2p5b1" path="res://assets/test_object/test_enemy.tscn" id="4_1w1cq"]
[ext_resource type="Texture2D" uid="uid://cymkwab2d6rwg" path="res://assets/texture/texture_09.png" id="5_aptcq"]
[ext_resource type="Script" path="res://components/enemy_spawner.gd" id="7_pnolh"]
[ext_resource type="Script" path="res://components/wave_control.gd" id="8_eo31v"]

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_sxam8"]
albedo_color = Color(0, 0.317647, 1, 1)

[sub_resource type="BoxMesh" id="BoxMesh_pakoe"]
material = SubResource("StandardMaterial3D_sxam8")

[sub_resource type="NavigationMesh" id="NavigationMesh_unpe7"]
vertices = PackedVector3Array(0, 0.542601, -10.5, -10.5, 0.542601, 0, -10.5, 0.542601, 10.5, 0, 0.542601, 10.5, 10.5, 0.542601, 0, 10.5, 0.542601, -10.5, 0, 0.542601, 10.5, 10.5, 0.542601, 10.5, 10.5, 0.542601, 0, 0, 0.542601, -10.5, -10.5, 0.542601, -10.5, -10.5, 0.542601, 0)
polygons = [PackedInt32Array(5, 4, 0), PackedInt32Array(0, 4, 3), PackedInt32Array(0, 3, 1), PackedInt32Array(1, 3, 2), PackedInt32Array(8, 7, 6), PackedInt32Array(11, 10, 9)]
agent_max_slope = 60.0

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_7o4gv"]
albedo_texture = ExtResource("5_aptcq")
uv1_scale = Vector3(0.169, 0.169, 0.169)
uv1_offset = Vector3(0.138, 0.1, 0.19)
uv1_triplanar = true

[sub_resource type="BoxMesh" id="BoxMesh_xor63"]
material = SubResource("StandardMaterial3D_7o4gv")
size = Vector3(22, 1, 22)

[node name="Sandbox" type="Node3D"]

[node name="Player" type="CharacterBody3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.517074, 8.95896)
script = ExtResource("1_gg6jg")
metadata/_edit_group_ = true

[node name="Test Object" type="MeshInstance3D" parent="Player"]
mesh = SubResource("BoxMesh_pakoe")

[node name="Hand" type="Marker3D" parent="Player/Test Object"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, -0.476559)

[node name="Gun Controller" type="Node" parent="Player"]
script = ExtResource("2_d5ebt")
starting_weapon = ExtResource("3_vf412")

[node name="Camera3D" type="Camera3D" parent="."]
transform = Transform3D(1, 0, 0, 0, -0.00701615, 0.999975, 0, -0.999975, -0.00701615, 0, 14.4044, -0.2745)

[node name="DirectionalLight3D" type="DirectionalLight3D" parent="."]
transform = Transform3D(-0.53985, -0.692127, 0.479086, -0.0214931, 0.580295, 0.814123, -0.841487, 0.429207, -0.328148, 2.10275, 5.75976, 13.5023)
shadow_enabled = true

[node name="Enemy" parent="." instance=ExtResource("4_1w1cq")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 5.75507, 1.00626, -4.64118)

[node name="Spawner" type="Node3D" parent="."]
script = ExtResource("7_pnolh")
Enemy = ExtResource("4_1w1cq")

[node name="spawn_timer" type="Timer" parent="Spawner"]

[node name="Waves" type="Node" parent="Spawner"]

[node name="Wave" type="Node" parent="Spawner/Waves"]
script = ExtResource("8_eo31v")

[node name="Wave2" type="Node" parent="Spawner/Waves"]
script = ExtResource("8_eo31v")
num_enemies = 10
second_between_spawn = 1.0

[node name="Wave3" type="Node" parent="Spawner/Waves"]
script = ExtResource("8_eo31v")
num_enemies = 50
second_between_spawn = 0.2

[node name="NavigationRegion3D" type="NavigationRegion3D" parent="."]
transform = Transform3D(1.9, 0, 0, 0, 1, 0, 0, 0, 1.4, 0, 0, 0)
navigation_mesh = SubResource("NavigationMesh_unpe7")

[node name="Environment" type="Node3D" parent="NavigationRegion3D"]

[node name="MeshInstance3D" type="MeshInstance3D" parent="NavigationRegion3D/Environment"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -0.457399, 0)
mesh = SubResource("BoxMesh_xor63")

[node name="Patrol Path" type="Node" parent="."]

[node name="Marker3D" type="Marker3D" parent="Patrol Path" groups=["enemy_waypoint"]]
transform = Transform3D(1.9, 0, 0, 0, 1, 0, 0, 0, 1.4, 17.1, 0, -14)

[node name="Marker3D2" type="Marker3D" parent="Patrol Path"]
transform = Transform3D(1.9, 0, 0, 0, 1, 0, 0, 0, 1.4, -19, 0, 0)

[node name="Marker3D3" type="Marker3D" parent="Patrol Path"]
transform = Transform3D(1.9, 0, 0, 0, 1, 0, 0, 0, 1.4, -5.7, 0, -14)

[connection signal="timeout" from="Spawner/spawn_timer" to="Spawner" method="_on_spawn_timer_timeout"]
